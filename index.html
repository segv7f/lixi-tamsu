<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Lì Xì Buồn</title>

<link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">

<style>
body{
    margin:0;
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    background:radial-gradient(circle at center,#2b0000,#080000);
    overflow:hidden;
    font-family:'Patrick Hand',cursive;
    transition:1s;
}

/* Fade buồn khi đóng */
.fade{
    opacity:0.4;
    filter:blur(3px);
}

/* ===== MƯA ===== */
.rain{
    position:absolute;
    width:2px;
    height:25px;
    background:rgba(255,255,255,0.12);
    animation:fall linear infinite;
}
@keyframes fall{
    0%{transform:translateY(-10vh)}
    100%{transform:translateY(110vh)}
}

/* ===== BAO ===== */
.envelope{
    position:relative;
    width:380px;
    height:540px;
    background:#7a0000;
    border-radius:20px;
    box-shadow:0 40px 80px rgba(0,0,0,0.9);
    overflow:hidden;
    z-index:1;
}

.flap{
    position:absolute;
    width:100%;
    height:280px;
    background:#5a0000;
    top:0;
    clip-path:polygon(0 0,100% 0,50% 100%);
    transform-origin:top;
    transition:1.2s ease;
    z-index:3;
}

.button-seal{
    position:absolute;
    width:40px;
    height:40px;
    background:#b8860b;
    border-radius:50%;
    top:250px;
    left:50%;
    transform:translateX(-50%);
    cursor:pointer;
    z-index:4;
    transition:0.6s;
    box-shadow:0 0 20px rgba(255,215,0,0.6);
}

.drop{
    transform:translate(-50%,170px);
    opacity:0;
}

@keyframes shake{
    0%{transform:translateX(0)}
    25%{transform:translateX(-8px)}
    50%{transform:translateX(8px)}
    75%{transform:translateX(-4px)}
    100%{transform:translateX(0)}
}
.shake{ animation:shake 0.9s; }

.open .flap{
    transform:rotateX(180deg);
}

/* ===== NOTE ===== */
.note{
    position:absolute;
    width:94%;
    height:80%;
    background:#fffef4;
    left:50%;
    bottom:-130%;
    transform:translateX(-50%);
    transition:1.2s ease;
    border-radius:12px;
    box-shadow:0 25px 50px rgba(0,0,0,0.7);
    overflow:hidden;
    z-index:2;
    cursor:pointer;
}

.show-note{
    bottom:40px;
}

/* Zoom đè lên bao */
.zoom{
    position:fixed !important;
    top:50%;
    left:50%;
    bottom:auto;
    transform:translate(-50%,-50%) scale(1.2);
    width:85%;
    height:85%;
    z-index:999;
    box-shadow:0 50px 100px rgba(0,0,0,0.95);
}

/* Vùng scroll */
.note-content{
    position:absolute;
    top:0;
    left:0;
    right:0;
    bottom:0;
    padding:70px 45px 45px 70px;
    overflow:auto;
    box-sizing:border-box;

    /* dòng kẻ cố định */
    background-image:linear-gradient(#e0e0e0 2px, transparent 2px);
    background-size:100% 45px;
    background-position:0 130px;
}

/* ẩn scrollbar xấu */
.note-content::-webkit-scrollbar{
    width:6px;
}
.note-content::-webkit-scrollbar-thumb{
    background:#ccc;
    border-radius:4px;
}

/* LỀ ĐỎ CỐ ĐỊNH */
.red-line{
    position:absolute;
    top:0;
    bottom:0;
    left:55px;
    width:2px;
    background:#ffb3b3;
    z-index:5;
    pointer-events:none;
}

/* chữ */
.text{
    font-size:22px;
    line-height:45px;
    color:#1a1a1a;
    white-space:pre-wrap;
    word-break:break-word;
    text-shadow:0 0 1px rgba(0,0,0,0.3);
}

/* nhòe nước mắt */
.tear{
    filter:blur(1px);
}
</style>
</head>
<body>

<div class="envelope" id="envelope">
    <div class="flap"></div>
    <div class="button-seal" id="seal"></div>

    <div class="note" id="note">
        <div class="red-line"></div>
        <div class="note-content" id="noteContent">
            <div class="text" id="text"></div>
        </div>
    </div>
</div>

<audio id="heartbeat" src="https://www.soundjay.com/human/heartbeat-01a.mp3" loop></audio>

<script>
const seal=document.getElementById("seal");
const envelope=document.getElementById("envelope");
const note=document.getElementById("note");
const text=document.getElementById("text");
const noteContent=document.getElementById("noteContent");
const heartbeat=document.getElementById("heartbeat");

let opened=false;

const message=`Chúc em hạnh phúc, anh chúc mọi điều tốt đẹp sẽ đến với em.

Anh mong người đó
sẽ nắm tay em
những lúc em yếu lòng.

Mong em luôn được yêu,
luôn được che chở,
và không còn rơi nước mắt
vì anh nữa.

Nếu một ngày em nhớ lại,
hãy nhớ rằng
đã từng có một người
yêu em nhiều đến thế.

Chỉ là người đó…
không còn được đứng cạnh em nữa.

Anh không trách em đâu.
Có lẽ chỉ là mình đã đi cùng nhau
đến hết đoạn đường của mình rồi.

Anh từng nghĩ
chỉ cần cố thêm một chút
thì mọi thứ sẽ khác.
Nhưng hóa ra,
có những điều
càng cố giữ
càng rời xa.

Sau này nếu em mệt,
hãy tựa vào vai người ta nhé.
Đừng giống như trước,
cố mạnh mẽ rồi lặng lẽ khóc một mình.

Anh sẽ ổn thôi.
Chỉ là sẽ mất một thời gian
để tập quen với những buổi tối
không còn tin nhắn của em,
quen với việc đi ngang con đường cũ
mà không còn ai đi bên cạnh.

Nếu một ngày vô tình gặp lại,
anh mong mình có thể mỉm cười chào nhau
như hai người đã từng rất thương,
nhưng không đủ duyên để ở lại.

Cảm ơn em
vì đã từng đến.

Và xin lỗi
vì đã không thể đi cùng em
đến cuối cùng.

`;

/* Viết + auto scroll */
function typeWriter(content,i=0){
    if(i<content.length){
        text.innerHTML+=content.charAt(i);
        noteContent.scrollTop=noteContent.scrollHeight;
        setTimeout(()=>typeWriter(content,i+1),45);
    }
}

/* Mở bao */
seal.addEventListener("click",e=>{
    e.stopPropagation();
    opened=true;
    seal.classList.add("drop");
    envelope.classList.add("shake");

    setTimeout(()=>envelope.classList.add("open"),800);
    setTimeout(()=>{
        note.classList.add("show-note");
        typeWriter(message);
    },1500);
});

/* Zoom */
note.addEventListener("click",e=>{
    e.stopPropagation();
    note.classList.toggle("zoom");

    if(note.classList.contains("zoom")){
        heartbeat.volume=0.25;
        heartbeat.play();
        text.classList.add("tear");
    }else{
        heartbeat.pause();
        text.classList.remove("tear");
    }
});

/* Đóng */
document.body.addEventListener("click",()=>{
    if(!opened) return;

    document.body.classList.add("fade");

    setTimeout(()=>{
        envelope.classList.remove("open","shake");
        note.classList.remove("show-note","zoom");
        seal.classList.remove("drop");
        text.innerHTML="";
        heartbeat.pause();
        document.body.classList.remove("fade");
        opened=false;
    },900);
});

/* Tạo mưa */
for(let i=0;i<70;i++){
    let drop=document.createElement("div");
    drop.className="rain";
    drop.style.left=Math.random()*100+"vw";
    drop.style.animationDuration=(1+Math.random()*2)+"s";
    document.body.appendChild(drop);
}
</script>

</body>
</html>